# yaml-language-server: $schema=./schema.json

###-----------------------------------------------------------------------------
### %CopyrightBegin%
###
### SPDX-License-Identifier: Apache-2.0
###
### Copyright (c) Meta Platforms, Inc. and affiliates.
### Copyright (c) WhatsApp LLC
###
### Licensed under the Apache License, Version 2.0 (the "License");
### you may not use this file except in compliance with the License.
### You may obtain a copy of the License at
###
###     http://www.apache.org/licenses/LICENSE-2.0
###
### Unless required by applicable law or agreed to in writing, software
### distributed under the License is distributed on an "AS IS" BASIS,
### WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
### See the License for the specific language governing permissions and
### limitations under the License.
###
### %CopyrightEnd%
###-----------------------------------------------------------------------------

---
suite:
  name: block_quote
  created: 2025-10-27
  modified: 2025-10-27
shared_options:
  - name: danger
    options:
      compile:
        allow_dangerous_html: true
        allow_dangerous_protocol: true
to_html:
- name: test_block_quote_case_1
  input: |-
    > # a
    > b
    > c
  output: |-
    <blockquote>
    <h1>a</h1>
    <p>b
    c</p>
    </blockquote>
  message: should support block quotes
- name: test_block_quote_case_2
  input: |-
    ># a
    >b
    > c
  output: |-
    <blockquote>
    <h1>a</h1>
    <p>b
    c</p>
    </blockquote>
  message: should support block quotes w/o space
- name: test_block_quote_case_3
  input: |2-
       > # a
       > b
     > c
  output: |-
    <blockquote>
    <h1>a</h1>
    <p>b
    c</p>
    </blockquote>
  message: should support prefixing block quotes w/ spaces
- name: test_block_quote_case_4
  input: |2-
        > # a
        > b
        > c
  output: |-
    <pre><code>&gt; # a
    &gt; b
    &gt; c
    </code></pre>
  message: should not support block quotes w/ 4 spaces
- name: test_block_quote_case_5
  input: |-
    > # a
    > b
    c
  output: |-
    <blockquote>
    <h1>a</h1>
    <p>b
    c</p>
    </blockquote>
  message: should support lazy content lines
- name: test_block_quote_case_6
  input: |-
    > a
    b
    > c
  output: |-
    <blockquote>
    <p>a
    b
    c</p>
    </blockquote>
  message: should support lazy content lines inside block quotes
- name: test_block_quote_case_7
  input: |-
    > a
    > ---
  output: |-
    <blockquote>
    <h2>a</h2>
    </blockquote>
  message: should support setext headings underlines in block quotes
- name: test_block_quote_case_8
  input: |-
    > a
    ---
  output: |-
    <blockquote>
    <p>a</p>
    </blockquote>
    <hr />
  message: should not support lazy setext headings underlines in block quotes
- name: test_block_quote_case_9
  input: |-
    > - a
    > - b
  output: |-
    <blockquote>
    <ul>
    <li>a</li>
    <li>b</li>
    </ul>
    </blockquote>
  message: should support lists in block quotes
- name: test_block_quote_case_10
  input: |-
    > - a
    - b
  output: |-
    <blockquote>
    <ul>
    <li>a</li>
    </ul>
    </blockquote>
    <ul>
    <li>b</li>
    </ul>
  message: should not support lazy lists in block quotes
- name: test_block_quote_case_11
  input: |-
    >     a
        b
  output: |-
    <blockquote>
    <pre><code>a
    </code></pre>
    </blockquote>
    <pre><code>b
    </code></pre>
  message: should not support lazy indented code in block quotes
- name: test_block_quote_case_12
  input: |-
    > ```
    a
    ```
  output: |
    <blockquote>
    <pre><code></code></pre>
    </blockquote>
    <p>a</p>
    <pre><code></code></pre>
  message: should not support lazy fenced code in block quotes (1)
- name: test_block_quote_case_13
  input: |-
    > a
    ```
    b
  output: |
    <blockquote>
    <p>a</p>
    </blockquote>
    <pre><code>b
    </code></pre>
  message: should not support lazy fenced code in block quotes (2)
- name: test_block_quote_case_14
  input: |-
    > a
        - b
  output: |-
    <blockquote>
    <p>a
    - b</p>
    </blockquote>
  message: should not support lazy indented code (or lazy list) in block quotes
- name: test_block_quote_case_15
  input: |-
    > [
    a
  output: |-
    <blockquote>
    <p>[
    a</p>
    </blockquote>
  message: should support lazy, definition-like lines
- name: test_block_quote_case_16
  input: |-
    > [a]: b
    c
  output: |-
    <blockquote>
    <p>c</p>
    </blockquote>
  message: should support a definition, followed by a lazy paragraph
- name: test_block_quote_case_17
  input: '>'
  output: |-
    <blockquote>
    </blockquote>
  message: should support empty block quotes (1)
- name: test_block_quote_case_18
  input: ">\n>  \n> "
  output: |-
    <blockquote>
    </blockquote>
  message: should support empty block quotes (2)
- name: test_block_quote_case_19
  input: ">\n> a\n>  "
  output: |-
    <blockquote>
    <p>a</p>
    </blockquote>
  message: should support initial or final lazy empty block quote lines
- name: test_block_quote_case_20
  input: |-
    > a

    > b
  output: |-
    <blockquote>
    <p>a</p>
    </blockquote>
    <blockquote>
    <p>b</p>
    </blockquote>
  message: should support adjacent block quotes
- name: test_block_quote_case_21
  input: |-
    > a
    > b
  output: |-
    <blockquote>
    <p>a
    b</p>
    </blockquote>
  message: should support a paragraph in a block quote
- name: test_block_quote_case_22
  input: |-
    > a
    >
    > b
  output: |-
    <blockquote>
    <p>a</p>
    <p>b</p>
    </blockquote>
  message: should support adjacent paragraphs in block quotes
- name: test_block_quote_case_23
  input: |-
    [a]

    > [a]: b
  output: |-
    <p><a href="b">a</a></p>
    <blockquote>
    </blockquote>
  message: should support a definition in a block quote (1)
- name: test_block_quote_case_24
  input: |-
    > [a]: b

    [a]
  output: |-
    <blockquote>
    </blockquote>
    <p><a href="b">a</a></p>
  message: should support a definition in a block quote (2)
- name: test_block_quote_case_25
  input: |-
    a
    > b
  output: |-
    <p>a</p>
    <blockquote>
    <p>b</p>
    </blockquote>
  message: should support interrupting paragraphs w/ block quotes
- name: test_block_quote_case_26
  input: |-
    > a
    ***
    > b
  output: |-
    <blockquote>
    <p>a</p>
    </blockquote>
    <hr />
    <blockquote>
    <p>b</p>
    </blockquote>
  message: should support interrupting block quotes w/ thematic breaks
- name: test_block_quote_case_27
  input: |-
    > a
    b
  output: |-
    <blockquote>
    <p>a
    b</p>
    </blockquote>
  message: should not support interrupting block quotes w/ paragraphs
- name: test_block_quote_case_28
  input: |-
    > a

    b
  output: |-
    <blockquote>
    <p>a</p>
    </blockquote>
    <p>b</p>
  message: should support interrupting block quotes w/ blank lines
- name: test_block_quote_case_29
  input: |-
    > a
    >
    b
  output: |-
    <blockquote>
    <p>a</p>
    </blockquote>
    <p>b</p>
  message: should not support interrupting a blank line in a block quotes w/ paragraphs
- name: test_block_quote_case_30
  input: |-
    > > > a
    b
  output: |-
    <blockquote>
    <blockquote>
    <blockquote>
    <p>a
    b</p>
    </blockquote>
    </blockquote>
    </blockquote>
  message: should not support interrupting many block quotes w/ paragraphs (1)
- name: test_block_quote_case_31
  input: |-
    >>> a
    > b
    >>c
  output: |-
    <blockquote>
    <blockquote>
    <blockquote>
    <p>a
    b
    c</p>
    </blockquote>
    </blockquote>
    </blockquote>
  message: should not support interrupting many block quotes w/ paragraphs (2)
- name: test_block_quote_case_32
  input: |-
    >     a

    >    b
  output: |-
    <blockquote>
    <pre><code>a
    </code></pre>
    </blockquote>
    <blockquote>
    <p>b</p>
    </blockquote>
  message: should support 5 spaces for indented code, not 4
to_html_with_options:
- name: test_block_quote_case_33
  input: |-
    > # a
    > b
    > c
  output: |-
    <p>&gt; # a
    &gt; b
    &gt; c</p>
  message: should support turning off block quotes
  options:
    parse:
      constructs:
        block_quote: false
to_mdast:
- name: test_block_quote_case_34
  input: '> a'
  output: |-
    markdown_mdast_node:root(#markdown_mdast_root{
        children = ?'vec!'([
            markdown_mdast_node:blockquote(#markdown_mdast_blockquote{
                children = ?'vec!'([
                    markdown_mdast_node:paragraph(#markdown_mdast_paragraph{
                        children = ?'vec!'([
                            markdown_mdast_node:text(#markdown_mdast_text{
                                value = <<"a">>,
                                position = {some, markdown_unist_position:new(1, 3, 2, 1, 4, 3)}
                            })
                        ]),
                        position = {some, markdown_unist_position:new(1, 3, 2, 1, 4, 3)}
                    })
                ]),
                position = {some, markdown_unist_position:new(1, 1, 0, 1, 4, 3)}
            })
        ]),
        position = {some, markdown_unist_position:new(1, 1, 0, 1, 4, 3)}
    })
  message: "should support block quotes as `BlockQuote`s in mdast"
  parse_options: {}

